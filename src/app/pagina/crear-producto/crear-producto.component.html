<div class="container custom-container">
  <div class="card p-5 bg-light">
    <form #f="ngForm">
      <fieldset class="mb-4">
        <legend class="text-center text-primary mb-4">
          <div class="d-flex flex-column align-items-center">
            <i class="fas fa-plus-circle fa-3x background-color-"></i>
            ¡Crea un nuevo producto!
          </div>
        </legend>

        <div class="mb-4 row">
          <div class="col-form-control">
            <div class="input-group">
              <div class="input-group-text">
                <span class="input-group-text bg-light border-0 px-0">
                  <i class="fas fa-tag fa-lg text-primary bg-light"></i>
                </span>
              </div>
              <input
                #nombreProducto="ngModel"
                class="form-control border-1 input-group-text bg-custom"
                [ngClass]="{
                  'is-invalid':
                    nombreProducto.invalid &&
                    (nombreProducto.dirty || nombreProducto.touched)
                }"
                type="text"
                f
                id="nombreProducto"
                name="nombreProducto"
                [(ngModel)]="producto.nombreProducto"
                required
                placeholder="Ingresa el nombre del producto"
                maxlength="50"
              />
              <div
                *ngIf="
                  nombreProducto.invalid &&
                  (nombreProducto.dirty || nombreProducto.touched)
                "
                class="invalid-feedback"
              >
                <div *ngIf="nombreProducto.touched && nombreProducto.errors">
                  El nombre es obligatorio
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mb-4 row">
          <div class="col-form-control">
            <div class="input-group">
              <div class="input-group-text">
                <span class="input-group-text bg-light border-0 px-0">
                  <i class="fas fa-file-alt fa-lg text-primary bg-light"></i>
                </span>
              </div>
              <textarea
                #descripcionProducto="ngModel"
                class="form-control border-1 input-group-text bg-custom"
                [ngClass]="{
                  'is-invalid':
                    descripcionProducto.invalid &&
                    (descripcionProducto.dirty || descripcionProducto.touched)
                }"
                type="text"
                id="descripcionProducto"
                name="descripcionProducto"
                [(ngModel)]="producto.descripcionProducto"
                required
                placeholder="Ingresa la descripción del producto"
                rows="5"
                maxlength="500"
              ></textarea>
              <div
                *ngIf="
                  descripcionProducto.invalid &&
                  (descripcionProducto.dirty || descripcionProducto.touched)
                "
                class="invalid-feedback"
              >
                <div
                  *ngIf="
                    descripcionProducto.touched && descripcionProducto.errors
                  "
                >
                  El producto tiene que tener una descripcion
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mb-4 row">
          <div class="col-form-control">
            <div class="input-group">
              <div class="input-group-text">
                <span class="input-group-text bg-light border-0 px-0">
                  <i class="fas fa-box fa-lg text-primary bg-light"></i>
                </span>
              </div>
              <input
                #unidadesDisponibles="ngModel"
                class="form-control border-1 input-group-text bg-custom"
                [ngClass]="{
                  'is-invalid':
                    unidadesDisponibles.invalid &&
                    (unidadesDisponibles.dirty || unidadesDisponibles.touched)
                }"
                type="number"
                id="unidadesDisponibles"
                name="unidadesDisponibles"
                [(ngModel)]="producto.unidadesDisponibles"
                required
                placeholder="Ingresa las unidades disponibles"
              />
              <div
                *ngIf="
                  unidadesDisponibles.invalid &&
                  (unidadesDisponibles.dirty || unidadesDisponibles.touched)
                "
                class="invalid-feedback"
              >
                <div *ngIf="unidadesDisponibles.errors?.['required']">
                  Las unidades disponibles son obligatorias
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mb-4 row">
          <div class="col-form-control">
            <div class="input-group">
              <div class="input-group-text">
                <span class="input-group-text bg-light border-0 px-0">
                  <i class="fas fa-dollar-sign fa-lg text-primary bg-light"></i>
                </span>
              </div>
              <input
                #precioActual="ngModel"
                class="form-control border-1 input-group-text bg-custom"
                [ngClass]="{
                  'is-invalid':
                    precioActual.invalid &&
                    (precioActual.dirty || precioActual.touched)
                }"
                type="number"
                id="precioActual"
                name="precioActual"
                [(ngModel)]="producto.precioActual"
                required
                placeholder="Ingresa el precio del producto"
              />
              <div
                *ngIf="
                  precioActual.invalid &&
                  (precioActual.dirty || precioActual.touched)
                "
                class="invalid-feedback"
              >
                <div *ngIf="precioActual.errors?.['required']">
                  Debe tener un precio
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mb-4 row">
          <div class="col">
            <div class="input-group">
              <div class="input-group-text">
                <span class="input-group-text bg-light border-0 px-0">
                  <i class="fas fa-image fa-lg text-primary bg-light"></i>
                </span>
              </div>
              <div
                class="form-control border-1 input-group-text file-input-wrapper bg-custom d-flex align-items-center"
              >
                <input
                  type="file"
                  name="imagenes"
                  id="imagenes"
                  (change)="onFileChange($event)"
                  multiple
                />
                <label for="imagenes" class="file-input-label flex-grow-1">
                  <span
                    style="color: #808080; max-width: 100%"
                    class="text-center"
                  >
                    <button
                      type="submit"
                      [disabled]="archivos == null"
                      class="btn btn-primary"
                      (click)="subirImagenes()"
                    >
                      <i class="fa-solid fa-cloud-arrow-up me-2"></i>Subir
                      imágenes
                    </button>
                  </span>
                </label>
              </div>
            </div>
          </div>
        </div>


        <div class="mb-4 row">
          <div class="col-form-control">
            <div class="checkbox-list">
              <div class="input-group-text">
                <span class="input-group-text bg-light border-0 px-0">
                  <i class="fas fa-tags fa-lg text-primary bg-light"></i>
                </span>


                <div class="form-control border-1 input-group-text bg-custom categorias-container">
                  <div *ngFor="let categoria of categorias; let i = index">
                    <label class="form-check-label">
                      <input type="checkbox" name="categoria_{{i}}" [checked]="producto.categorias.includes(categoria)" (change)="toggleCategoria(categoria)" class="form-check-input">
                      {{ categoria }}
                    </label>
                  </div>
                </div>

            </div>
            </div>
          </div>
        </div>


        <div class="text-center">
          <button
            type="submit"
            (click)="crearProducto()"
            [disabled]="f.invalid"
            class="btn btn-primary"
          >
            <i
              class="fa-solid
    {{ esEdicion ? 'fa-pencil' : 'fa-circle-plus' }} me-1"
            ></i
            >{{ esEdicion ? "Editar" : "Crear" }} Producto
          </button>
        </div>
      </fieldset>
    </form>
  </div>
</div>
